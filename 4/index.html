<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì£¼ë°© ì£¼ë¬¸ í˜„í™©</title>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #333; color: white; }
        .order-card { background: white; color: black; padding: 15px; margin-bottom: 10px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; }
        .order-info { font-size: 1.1rem; width: 80%; }
        .table-num { font-weight: bold; color: #d32f2f; font-size: 1.5rem; margin-right: 10px; display:inline-block; min-width:80px; }
        .menu-text { line-height: 1.5; display: inline-block; vertical-align: middle; }
        .btn-done { background: #4caf50; color: white; border: none; padding: 15px 25px; border-radius: 5px; cursor: pointer; font-size: 1.2rem; font-weight: bold; }
    </style>
</head>
<body>
    <h1>ğŸ”¥ ì‹¤ì‹œê°„ ì£¼ë¬¸ í˜„í™© (ì£¼ë°©)</h1>
    <div id="orderList">ì£¼ë¬¸ì„ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘...</div>

    <script type="module">
        // ì£¼ë°© ìª½ì—ë„ ë™ì¼í•œ í‚¤ë¥¼ ì ìš©í–ˆìŠµë‹ˆë‹¤.
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getFirestore, collection, onSnapshot, doc, deleteDoc, query, orderBy } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyC5lLY7p09aqglYrqYEF6hBBRxIOaB59Uk",
            authDomain: "madecafe-85738.firebaseapp.com",
            projectId: "madecafe-85738",
            storageBucket: "madecafe-85738.firebasestorage.app",
            messagingSenderId: "481793894590",
            appId: "1:481793894590:web:00873d3f6285c87d6756ef",
            measurementId: "G-HVE60ZL3XZ"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        const orderList = document.getElementById('orderList');

        const q = query(collection(db, "orders"), orderBy("time", "asc"));
        
        onSnapshot(q, (snapshot) => {
            orderList.innerHTML = ""; 
            if(snapshot.empty) {
                orderList.innerHTML = "<p>í˜„ì¬ ëŒ€ê¸° ì¤‘ì¸ ì£¼ë¬¸ì´ ì—†ìŠµë‹ˆë‹¤.</p>";
                return;
            }

            snapshot.forEach((docSnap) => {
                const data = docSnap.data();
                const id = docSnap.id;
                
                const html = `
                    <div class="order-card">
                        <div class="order-info">
                            <span class="table-num">T ${data.table}</span>
                            <span class="menu-text">${data.menu.join("<br>")}</span>
                        </div>
                        <button class="btn-done" onclick="completeOrder('${id}')">ì™„ë£Œ</button>
                    </div>
                `;
                orderList.innerHTML += html;
            });
        });

        window.completeOrder = async (id) => {
            if(confirm("ì¡°ë¦¬ê°€ ì™„ë£Œë˜ì—ˆë‚˜ìš”?")) {
                await deleteDoc(doc(db, "orders", id));
            }
        }
    </script>
</body>
</html>
