<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¬ê³  ê´€ë¦¬ì ğŸ“¦</title>
    <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Jua', sans-serif; background: #333; color: white; padding: 20px; text-align: center; }
        h1 { color: #ff80ab; }
        
        .item-list { max-width: 600px; margin: 0 auto; display: flex; flex-direction: column; gap: 10px; }
        .item-row { 
            background: #444; padding: 15px; border-radius: 10px; 
            display: flex; justify-content: space-between; align-items: center;
            border: 1px solid #555;
        }
        .item-name { text-align: left; font-size: 16px; flex: 1; margin-right: 10px; }
        .stock-control { display: flex; align-items: center; gap: 5px; }
        
        input { width: 60px; padding: 8px; text-align: center; font-size: 18px; border-radius: 5px; border: none; }
        button { cursor: pointer; border: none; border-radius: 5px; padding: 8px 15px; font-family: 'Jua'; }
        
        .btn-save { background: #ff80ab; color: white; }
        .btn-save:hover { background: #d81b60; }
        
        .init-btn { margin-top: 30px; background: #555; color: #aaa; padding: 10px; }
    </style>
</head>
<body>
    <h1>ğŸ“¦ ì‹¤ì‹œê°„ ì¬ê³  ê´€ë¦¬</h1>
    <div id="inventoryList" class="item-list">ë¡œë”©ì¤‘...</div>

    <br>
    <button class="init-btn" onclick="initializeData()">âš ï¸ ë©”ë‰´ ë°ì´í„° ì´ˆê¸°í™” (ì²˜ìŒ í•œ ë²ˆë§Œ)</button>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getFirestore, collection, doc, onSnapshot, setDoc, updateDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyC5lLY7p09aqglYrqYEF6hBBRxIOaB59Uk",
            authDomain: "madecafe-85738.firebaseapp.com",
            projectId: "madecafe-85738",
            storageBucket: "madecafe-85738.firebasestorage.app",
            messagingSenderId: "481793894590",
            appId: "1:481793894590:web:00873d3f6285c87d6756ef",
            measurementId: "G-HVE60ZL3XZ"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // ë©”ë‰´ ê¸°ë³¸ ì •ë³´ (ì´ë¦„ ë§¤ì¹­ìš©)
        const menuData = [
            { id: 1, name: "ì´ˆì½”íŒŒì´" },
            { id: 2, name: "ë©”ì§€ì»¬ ì—ì´ë“œ" },
            { id: 3, name: "ëŸ¬ë¸”ë¦¬ ì•¡ì²´" },
            { id: 4, name: "ê°•ëƒ‰ì´" },
            { id: 5, name: "ë‘ê·¼ë‘ê·¼ ë£°ë ›" },
            { id: 6, name: "ìŠ¤í˜ì…œ ì„œë¹„ìŠ¤" }
        ];

        // ì‹¤ì‹œê°„ ì¬ê³  ë¦¬ìŠ¤ë„ˆ
        onSnapshot(collection(db, "inventory"), (snapshot) => {
            const list = document.getElementById('inventoryList');
            list.innerHTML = "";
            
            // ë°ì´í„°ë¥¼ ID ìˆœì„œëŒ€ë¡œ ì •ë ¬
            const items = [];
            snapshot.forEach(doc => items.push({ id: doc.id, ...doc.data() }));
            items.sort((a,b) => a.id - b.id);

            items.forEach(item => {
                list.innerHTML += `
                    <div class="item-row">
                        <div class="item-name">${item.name}</div>
                        <div class="stock-control">
                            <span>í˜„ì¬: </span>
                            <input type="number" id="val-${item.id}" value="${item.count}">
                            <button class="btn-save" onclick="updateStock('${item.id}')">ìˆ˜ì •</button>
                        </div>
                    </div>
                `;
            });
        });

        // ì¬ê³  ìˆ˜ì • í•¨ìˆ˜
        window.updateStock = async (id) => {
            const newVal = document.getElementById(`val-${id}`).value;
            await updateDoc(doc(db, "inventory", id), {
                count: parseInt(newVal)
            });
            alert("ìˆ˜ì • ì™„ë£Œ!");
        }

        // ì´ˆê¸° ë°ì´í„° ì„¸íŒ… (ì²˜ìŒ í•œ ë²ˆë§Œ ì‹¤í–‰)
        window.initializeData = async () => {
            if(!confirm("ëª¨ë“  ì¬ê³ ê°€ 100ê°œë¡œ ì´ˆê¸°í™”ë©ë‹ˆë‹¤. í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;
            
            for(const menu of menuData) {
                // ë¬¸ì„œ IDë¥¼ ìˆ«ìë¡œ ë¬¸ìì—´í™”í•˜ì—¬ ì €ì¥ ('1', '2'...)
                await setDoc(doc(db, "inventory", String(menu.id)), {
                    id: menu.id,
                    name: menu.name,
                    count: 100 // ê¸°ë³¸ ì¬ê³ 
                });
            }
            alert("ì´ˆê¸°í™” ì™„ë£Œ!");
        }
    </script>
</body>
</html>
